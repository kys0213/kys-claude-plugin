---
name: afl:delegate
description: êµ¬í˜„ ìœ„ì„ - í™•ì •ëœ Checkpointë¥¼ ììœ¨ ì—ì´ì „íŠ¸ì—ê²Œ ìœ„ì„í•˜ì—¬ ìë™ êµ¬í˜„/ê²€ì¦
argument-hint: "<checkpoint-id> | --session <session-id> [--all]"
allowed-tools: ["Task", "Bash", "Read", "Write", "Glob", "Grep", "AskUserQuestion"]
---

# Delegate Command

í™•ì •ëœ Checkpointë¥¼ **ììœ¨ ì—ì´ì „íŠ¸**ì—ê²Œ ìœ„ì„í•©ë‹ˆë‹¤.

## í•µì‹¬ ì›ì¹™

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  AUTONOMOUS DELEGATION: ì—ì´ì „íŠ¸ê°€ "ì–´ë–»ê²Œ"ë¥¼ ììœ¨ì ìœ¼ë¡œ ê²°ì •   â”‚
â”‚                                                                 â”‚
â”‚  ì¸ê°„ì€:                                                        â”‚
â”‚  â€¢ ìœ„ì„ ì‹œì‘ë§Œ ê²°ì •                                             â”‚
â”‚  â€¢ ì—ìŠ¤ì»¬ë ˆì´ì…˜ ì‹œì—ë§Œ ê°œì…                                     â”‚
â”‚                                                                 â”‚
â”‚  ì—ì´ì „íŠ¸ëŠ”:                                                    â”‚
â”‚  â€¢ êµ¬í˜„ ë°©ë²• ììœ¨ ê²°ì •                                          â”‚
â”‚  â€¢ Checkpoint ê¸°ì¤€ìœ¼ë¡œ ìë™ ê²€ì¦                                â”‚
â”‚  â€¢ ì‹¤íŒ¨ ì‹œ ìë™ ë¶„ì„ + ì¬ì‹œë„                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ì‚¬ìš©ë²•

```bash
# íŠ¹ì • Checkpoint êµ¬í˜„ ìœ„ì„
/afl:delegate coupon-service

# ì„¸ì…˜ì˜ ëª¨ë“  Checkpoint ë³‘ë ¬ ìœ„ì„
/afl:delegate --session abc12345 --all

# íŠ¹ì • ì„¸ì…˜ì˜ íŠ¹ì • Checkpoint ìœ„ì„
/afl:delegate --session abc12345 coupon-api

# ì‹¤íŒ¨í•œ Checkpoint ì¬ì‹œë„
/afl:delegate --retry coupon-service
```

---

## ì‹¤í–‰ ì ˆì°¨

```
/afl:delegate --session abc12345 --all
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  STEP 1: ì‚¬ì „ ê²€ì¦                                            â”‚
â”‚                                                               â”‚
â”‚  â€¢ ì„¸ì…˜ ì¡´ì¬ í™•ì¸                                             â”‚
â”‚  â€¢ Checkpoint ìŠ¹ì¸ ì—¬ë¶€ í™•ì¸                                  â”‚
â”‚  â€¢ ì˜ì¡´ì„± ê·¸ë˜í”„ ë¶„ì„                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  STEP 2: ì‹¤í–‰ ê³„íš ìˆ˜ë¦½                                       â”‚
â”‚                                                               â”‚
â”‚  ì˜ì¡´ì„± ê¸°ë°˜ ì‹¤í–‰ ìˆœì„œ:                                       â”‚
â”‚                                                               â”‚
â”‚  Round 1 (ë³‘ë ¬):                                              â”‚
â”‚    â”œâ”€â”€ coupon-model (ì˜ì¡´ì„± ì—†ìŒ)                             â”‚
â”‚    â””â”€â”€ ...                                                    â”‚
â”‚                                                               â”‚
â”‚  Round 2 (Round 1 ì™„ë£Œ í›„):                                   â”‚
â”‚    â”œâ”€â”€ coupon-service (depends: coupon-model)                â”‚
â”‚    â””â”€â”€ ...                                                    â”‚
â”‚                                                               â”‚
â”‚  Round 3 (Round 2 ì™„ë£Œ í›„):                                   â”‚
â”‚    â””â”€â”€ coupon-api (depends: coupon-service)                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  STEP 3: ììœ¨ ì‹¤í–‰ ë£¨í”„ (í•µì‹¬)                                â”‚
â”‚                                                               â”‚
â”‚  ê° Checkpointì— ëŒ€í•´:                                        â”‚
â”‚                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  3.1 Worker ì—ì´ì „íŠ¸ ìƒì„±                               â”‚ â”‚
â”‚  â”‚                                                         â”‚ â”‚
â”‚  â”‚  â€¢ Task ë„êµ¬ë¡œ subagent ìƒì„±                           â”‚ â”‚
â”‚  â”‚  â€¢ Checkpoint spec + contracts ì „ë‹¬                    â”‚ â”‚
â”‚  â”‚  â€¢ ììœ¨ êµ¬í˜„ ì‹œì‘                                       â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                      â”‚                                        â”‚
â”‚                      â–¼                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  3.2 ìë™ ê²€ì¦ (Checkpoint validation)                  â”‚ â”‚
â”‚  â”‚                                                         â”‚ â”‚
â”‚  â”‚  â€¢ êµ¬í˜„ ì™„ë£Œ ì‹œ validation.command ì‹¤í–‰                â”‚ â”‚
â”‚  â”‚  â€¢ expected ê²°ê³¼ì™€ ë¹„êµ                                 â”‚ â”‚
â”‚  â”‚  â€¢ timeout ë‚´ ì™„ë£Œ í™•ì¸                                 â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                      â”‚                                        â”‚
â”‚                      â–¼                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  3.3 ê²°ê³¼ ë¶„ê¸°                                          â”‚ â”‚
â”‚  â”‚                                                         â”‚ â”‚
â”‚  â”‚  âœ… í†µê³¼ â†’ ë‹¤ìŒ Checkpoint ë˜ëŠ” ì™„ë£Œ                   â”‚ â”‚
â”‚  â”‚  âŒ ì‹¤íŒ¨ â†’ ìë™ í”¼ë“œë°± ìƒì„±                            â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                      â”‚                                        â”‚
â”‚                      â–¼ (ì‹¤íŒ¨ ì‹œ)                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  3.4 ìë™ í”¼ë“œë°± ë£¨í”„                                   â”‚ â”‚
â”‚  â”‚                                                         â”‚ â”‚
â”‚  â”‚  â€¢ ì‹¤íŒ¨ ì›ì¸ ë¶„ì„                                       â”‚ â”‚
â”‚  â”‚  â€¢ êµ¬ì²´ì  í”¼ë“œë°± ìƒì„±                                   â”‚ â”‚
â”‚  â”‚  â€¢ Workerì—ê²Œ í”¼ë“œë°± ì „ë‹¬                               â”‚ â”‚
â”‚  â”‚  â€¢ ì¬ì‹œë„ (ìµœëŒ€ NíšŒ)                                    â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                      â”‚                                        â”‚
â”‚                      â–¼ (ìµœëŒ€ ì¬ì‹œë„ ì´ˆê³¼)                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  3.5 ì—ìŠ¤ì»¬ë ˆì´ì…˜                                       â”‚ â”‚
â”‚  â”‚                                                         â”‚ â”‚
â”‚  â”‚  â€¢ ì‹¤íŒ¨ ë¶„ì„ ë¦¬í¬íŠ¸ ìƒì„±                                â”‚ â”‚
â”‚  â”‚  â€¢ ì„¤ê³„ ë¬¸ì œ ê°€ëŠ¥ì„± ì œì•ˆ                                â”‚ â”‚
â”‚  â”‚  â€¢ ì¸ê°„ì—ê²Œ ì•Œë¦¼                                        â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  STEP 4: ê²°ê³¼ ë³´ê³                                             â”‚
â”‚                                                               â”‚
â”‚  â€¢ ì „ì²´ ê²°ê³¼ ìš”ì•½                                             â”‚
â”‚  â€¢ ì„±ê³µí•œ Checkpoint ëª©ë¡                                     â”‚
â”‚  â€¢ ì‹¤íŒ¨í•œ Checkpoint + ì›ì¸ ë¶„ì„                              â”‚
â”‚  â€¢ ë‹¤ìŒ ë‹¨ê³„ ì œì•ˆ                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## STEP 3: ììœ¨ ì‹¤í–‰ ë£¨í”„ ìƒì„¸

### 3.1 Worker ì—ì´ì „íŠ¸ í”„ë¡¬í”„íŠ¸

```markdown
# Implementation Task: {checkpoint-id}

ë‹¹ì‹ ì€ êµ¬í˜„ ì „ë¬¸ ì—ì´ì „íŠ¸ì…ë‹ˆë‹¤. ì•„ë˜ Checkpointë¥¼ êµ¬í˜„í•´ì£¼ì„¸ìš”.

## Checkpoint

**ì´ë¦„**: {name}
**ì„¤ëª…**: {description}

## ì„±ê³µ ê¸°ì¤€ (Criteria)

ë‹¤ìŒ ê¸°ì¤€ì„ **ëª¨ë‘** ì¶©ì¡±í•´ì•¼ í•©ë‹ˆë‹¤:

{criteria ëª©ë¡}

## ê²€ì¦ ë°©ë²•

```bash
{validation.command}
```

ì˜ˆìƒ ê²°ê³¼: `{validation.expected}`

## ì°¸ê³  ìë£Œ

### ì•„í‚¤í…ì²˜
{architecture.md ë‚´ìš©}

### ì¸í„°í˜ì´ìŠ¤ ê³„ì•½
{contracts.md ê´€ë ¨ ë¶€ë¶„}

## ì§€ì¹¨

1. ê¸°ì¡´ ì½”ë“œ ìŠ¤íƒ€ì¼ê³¼ íŒ¨í„´ì„ ë”°ë¥´ì„¸ìš”
2. ê° criterionì„ í•˜ë‚˜ì”© êµ¬í˜„í•˜ì„¸ìš”
3. êµ¬í˜„ í›„ ê²€ì¦ ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•˜ì—¬ í™•ì¸í•˜ì„¸ìš”
4. ëª¨ë“  ê¸°ì¤€ì´ í†µê³¼í•˜ë©´ ì™„ë£Œì…ë‹ˆë‹¤

## ì œì•½ ì‚¬í•­

- ìŠ¤í™ì— ëª…ì‹œë˜ì§€ ì•Šì€ ê¸°ëŠ¥ì€ ì¶”ê°€í•˜ì§€ ë§ˆì„¸ìš”
- ê¸°ì¡´ í…ŒìŠ¤íŠ¸ê°€ ê¹¨ì§€ì§€ ì•Šë„ë¡ í•˜ì„¸ìš”
- ì§ˆë¬¸ì´ ìˆìœ¼ë©´ AskUserQuestionì„ ì‚¬ìš©í•˜ì„¸ìš”
```

### 3.2 ìë™ ê²€ì¦ ë¡œì§

```typescript
async function validateCheckpoint(checkpoint: Checkpoint): Promise<ValidationResult> {
  const { command, expected, timeout } = checkpoint.validation;

  // ê²€ì¦ ëª…ë ¹ì–´ ì‹¤í–‰
  const result = await runCommand(command, { timeout });

  // ê²°ê³¼ ë¹„êµ
  if (result.stdout.includes(expected)) {
    return {
      passed: true,
      output: result.stdout
    };
  }

  // ì‹¤íŒ¨ ë¶„ì„
  return {
    passed: false,
    output: result.stdout,
    error: result.stderr,
    analysis: analyzeFailure(checkpoint, result)
  };
}
```

### 3.3 ìë™ í”¼ë“œë°± ìƒì„±

ì‹¤íŒ¨ ì‹œ êµ¬ì²´ì ì¸ í”¼ë“œë°±ì„ ìë™ ìƒì„±í•©ë‹ˆë‹¤.

```markdown
## ğŸ”„ ìë™ í”¼ë“œë°± (Iteration 2/5)

### ì‹¤íŒ¨í•œ ê¸°ì¤€

âŒ "ì¤‘ë³µ ì ìš© ì‹œ ì—ëŸ¬ ë°œìƒ"

### í…ŒìŠ¤íŠ¸ ì¶œë ¥

```
AssertionError: expected 200 to equal 409
  at Context.<anonymous> (test/coupon.test.ts:45:10)
```

### ë¶„ì„

- ì¤‘ë³µ ì ìš© ê²€ì‚¬ ë¡œì§ì´ êµ¬í˜„ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤
- CouponService.apply() ë©”ì„œë“œì—ì„œ ì´ë¯¸ ì ìš©ëœ ì¿ í° ì²´í¬ í•„ìš”

### ì œì•ˆ ìˆ˜ì •

```typescript
// src/services/coupon.service.ts
async apply(code: string, orderId: string): Promise<ApplyResult> {
  // ì¶”ê°€ í•„ìš”: ì¤‘ë³µ ì ìš© ê²€ì‚¬
  const existing = await this.couponUsageRepo.findByOrderId(orderId);
  if (existing) {
    throw new ConflictException('ì¿ í°ì´ ì´ë¯¸ ì ìš©ë˜ì—ˆìŠµë‹ˆë‹¤');
  }
  // ... ê¸°ì¡´ ë¡œì§
}
```

### ë‹¤ìŒ ë‹¨ê³„

ìœ„ í”¼ë“œë°±ì„ ë°˜ì˜í•˜ì—¬ ì¬êµ¬í˜„í•´ì£¼ì„¸ìš”.
```

### 3.4 ì—ìŠ¤ì»¬ë ˆì´ì…˜ ë¦¬í¬íŠ¸

ìµœëŒ€ ì¬ì‹œë„ ì´ˆê³¼ ì‹œ ì¸ê°„ì—ê²Œ ë³´ê³ í•©ë‹ˆë‹¤.

```markdown
## âš ï¸ ì—ìŠ¤ì»¬ë ˆì´ì…˜: coupon-service

### ìƒí™©

- Checkpoint: coupon-service (ì¿ í° ì„œë¹„ìŠ¤ ë¡œì§)
- ì‹œë„ íšŸìˆ˜: 3/3 (ìµœëŒ€ ë„ë‹¬)
- ë§ˆì§€ë§‰ ì‹¤íŒ¨: 2024-01-15 14:30:00

### ì‹¤íŒ¨ ì´ë ¥

| ì‹œë„ | ì‹¤íŒ¨ ê¸°ì¤€ | ì›ì¸ |
|-----|----------|------|
| 1 | validate() í…ŒìŠ¤íŠ¸ | null ì²´í¬ ëˆ„ë½ |
| 2 | ì¤‘ë³µ ì ìš© ê²€ì‚¬ | íŠ¸ëœì­ì…˜ ê²©ë¦¬ ë¬¸ì œ |
| 3 | ì¤‘ë³µ ì ìš© ê²€ì‚¬ | ë™ì‹œì„± race condition |

### ë¶„ì„

ë°˜ë³µì ìœ¼ë¡œ **ë™ì‹œì„± ê´€ë ¨** ì´ìŠˆê°€ ë°œìƒí•˜ê³  ìˆìŠµë‹ˆë‹¤.

**ê°€ëŠ¥í•œ ì›ì¸:**
1. ì„¤ê³„ ë‹¨ê³„ì—ì„œ ë™ì‹œì„± ìš”êµ¬ì‚¬í•­ ë¯¸ì •ì˜
2. íŠ¸ëœì­ì…˜ ê²©ë¦¬ ìˆ˜ì¤€ ëª…ì‹œ í•„ìš”
3. ë½ ì „ëµ ê²°ì • í•„ìš”

### ì œì•ˆ

**ì„¤ê³„ ì¬ê²€í†  ê¶Œì¥:**

```bash
/afl:architect --resume abc12345
```

ë‹¤ìŒ ì‚¬í•­ì„ ëª…í™•íˆ í•´ì£¼ì„¸ìš”:
1. ë™ì‹œì— ê°™ì€ ì¿ í° ì ìš© ì‹œ ì–´ë–»ê²Œ ì²˜ë¦¬?
2. ë¹„ê´€ì  ë½ vs ë‚™ê´€ì  ë½?
3. ì¬ì‹œë„ ì •ì±…ì€?
```

---

## íŒŒì¼ êµ¬ì¡°

```
.afl/
â””â”€â”€ sessions/
    â””â”€â”€ abc12345/
        â””â”€â”€ delegations/
            â”œâ”€â”€ status.json              # ì „ì²´ ìœ„ì„ ìƒíƒœ
            â”‚
            â””â”€â”€ coupon-service/          # checkpoint-id
                â”œâ”€â”€ status.json          # ê°œë³„ ìƒíƒœ
                â”œâ”€â”€ iterations/
                â”‚   â”œâ”€â”€ 1/
                â”‚   â”‚   â”œâ”€â”€ prompt.md    # Workerì—ê²Œ ì „ë‹¬í•œ í”„ë¡¬í”„íŠ¸
                â”‚   â”‚   â”œâ”€â”€ result.json  # ê²€ì¦ ê²°ê³¼
                â”‚   â”‚   â””â”€â”€ feedback.md  # í”¼ë“œë°± (ì‹¤íŒ¨ ì‹œ)
                â”‚   â”œâ”€â”€ 2/
                â”‚   â”‚   â””â”€â”€ ...
                â”‚   â””â”€â”€ 3/
                â”‚       â””â”€â”€ ...
                â”‚
                â””â”€â”€ final-result.json    # ìµœì¢… ê²°ê³¼
```

### status.json (ì „ì²´)

```json
{
  "sessionId": "abc12345",
  "status": "in_progress",
  "startedAt": "2024-01-15T12:00:00Z",
  "checkpoints": {
    "coupon-model": { "status": "completed", "iterations": 1 },
    "coupon-service": { "status": "in_progress", "iterations": 2 },
    "coupon-api": { "status": "pending" },
    "coupon-integration": { "status": "pending" }
  },
  "currentRound": 2,
  "totalRounds": 3
}
```

### status.json (ê°œë³„ Checkpoint)

```json
{
  "checkpointId": "coupon-service",
  "status": "in_progress",
  "iteration": 2,
  "maxIterations": 5,
  "startedAt": "2024-01-15T12:30:00Z",
  "lastAttemptAt": "2024-01-15T13:00:00Z",
  "history": [
    {
      "iteration": 1,
      "result": "failed",
      "failedCriteria": ["validate() í…ŒìŠ¤íŠ¸"],
      "timestamp": "2024-01-15T12:45:00Z"
    },
    {
      "iteration": 2,
      "result": "failed",
      "failedCriteria": ["ì¤‘ë³µ ì ìš© ê²€ì‚¬"],
      "timestamp": "2024-01-15T13:00:00Z"
    }
  ]
}
```

---

## ì¶œë ¥ ì˜ˆì‹œ

### ìœ„ì„ ì‹œì‘

```
ğŸš€ êµ¬í˜„ ìœ„ì„ ì‹œì‘

  ì„¸ì…˜: abc12345 (ì¿ í° í• ì¸ ê¸°ëŠ¥)

â”â”â” ì‹¤í–‰ ê³„íš â”â”â”

  Round 1 (ë³‘ë ¬):
    â€¢ coupon-model - ì¿ í° ë„ë©”ì¸ ëª¨ë¸

  Round 2 (Round 1 ì™„ë£Œ í›„):
    â€¢ coupon-service - ì¿ í° ì„œë¹„ìŠ¤ ë¡œì§

  Round 3 (Round 2 ì™„ë£Œ í›„):
    â€¢ coupon-api - ì¿ í° API ì—”ë“œí¬ì¸íŠ¸

  Round 4 (Round 3 ì™„ë£Œ í›„):
    â€¢ coupon-integration - í†µí•© í…ŒìŠ¤íŠ¸

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

â³ Round 1 ì‹œì‘...

  [Worker 1] coupon-model êµ¬í˜„ ì¤‘...
```

### ì§„í–‰ ìƒí™©

```
ğŸ“Š ìœ„ì„ ìƒíƒœ: abc12345

â”â”â” Round 2 ì§„í–‰ ì¤‘ â”â”â”

  âœ… coupon-model      ì™„ë£Œ (1íšŒ ì‹œë„)
  ğŸ”„ coupon-service    2/5íšŒ ì‹œë„ ì¤‘
     â””â”€ ë§ˆì§€ë§‰ ì‹¤íŒ¨: "ì¤‘ë³µ ì ìš© ê²€ì‚¬"
        ìë™ í”¼ë“œë°± ë°˜ì˜ í›„ ì¬ì‹œë„ ì¤‘...
  â¸ï¸ coupon-api        ëŒ€ê¸° ì¤‘
  â¸ï¸ coupon-integration ëŒ€ê¸° ì¤‘

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ìƒì„¸ ë¡œê·¸: .afl/sessions/abc12345/delegations/coupon-service/
```

### ì™„ë£Œ ë³´ê³ 

```
âœ… êµ¬í˜„ ìœ„ì„ ì™„ë£Œ: abc12345

â”â”â” ê²°ê³¼ ìš”ì•½ â”â”â”

  âœ… coupon-model       1íšŒ ì‹œë„, í†µê³¼
  âœ… coupon-service     3íšŒ ì‹œë„, í†µê³¼
  âœ… coupon-api         1íšŒ ì‹œë„, í†µê³¼
  âœ… coupon-integration 2íšŒ ì‹œë„, í†µê³¼

â”â”â” í†µê³„ â”â”â”

  ì´ ì‹œê°„: 45ë¶„
  ì´ ì‹œë„: 7íšŒ
  ì„±ê³µë¥ : 100% (4/4 Checkpoints)

â”â”â” ë‹¤ìŒ ë‹¨ê³„ â”â”â”

  ì½”ë“œ ë¦¬ë·°:
    /team-claude:review --session abc12345

  PR ìƒì„±:
    /team-claude:merge --session abc12345
```

### ì—ìŠ¤ì»¬ë ˆì´ì…˜

```
âš ï¸ ì—ìŠ¤ì»¬ë ˆì´ì…˜ ë°œìƒ

â”â”â” ì‹¤íŒ¨í•œ Checkpoint â”â”â”

  âŒ coupon-service (3/3íšŒ ì‹œë„ í›„ ì‹¤íŒ¨)

  ë°˜ë³µ ì‹¤íŒ¨ ì›ì¸: ë™ì‹œì„± race condition

â”â”â” ë¶„ì„ â”â”â”

  ì„¤ê³„ ë‹¨ê³„ì—ì„œ ë™ì‹œì„± ìš”êµ¬ì‚¬í•­ì´ ëª…í™•í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.

  ê°€ëŠ¥í•œ ì›ì¸:
  1. ë½ ì „ëµ ë¯¸ì •ì˜
  2. íŠ¸ëœì­ì…˜ ê²©ë¦¬ ìˆ˜ì¤€ ë¯¸ëª…ì‹œ

â”â”â” ê¶Œì¥ ì¡°ì¹˜ â”â”â”

  ì„¤ê³„ ì¬ê²€í† :
    /afl:architect --resume abc12345

  ìˆ˜ë™ êµ¬í˜„:
    /team-claude:spawn coupon-service

ìƒì„¸ ë¶„ì„: .afl/sessions/abc12345/delegations/coupon-service/
```

---

## ì„¤ì •

```json
{
  "delegation": {
    "autoValidateOnComplete": true,
    "autoRetryOnFail": true,
    "maxRetries": 3,
    "retryDelay": 5000,
    "parallelWorkers": 3,
    "escalationThreshold": 3
  }
}
```

| ì„¤ì • | ì„¤ëª… | ê¸°ë³¸ê°’ |
|-----|------|--------|
| `autoValidateOnComplete` | êµ¬í˜„ ì™„ë£Œ ì‹œ ìë™ ê²€ì¦ | `true` |
| `autoRetryOnFail` | ì‹¤íŒ¨ ì‹œ ìë™ ì¬ì‹œë„ | `true` |
| `maxRetries` | ìµœëŒ€ ì¬ì‹œë„ íšŸìˆ˜ | `3` |
| `retryDelay` | ì¬ì‹œë„ ê°„ ëŒ€ê¸° ì‹œê°„ (ms) | `5000` |
| `parallelWorkers` | ë™ì‹œ ì‹¤í–‰ Worker ìˆ˜ | `3` |
| `escalationThreshold` | ì—ìŠ¤ì»¬ë ˆì´ì…˜ íŠ¸ë¦¬ê±° íšŸìˆ˜ | `3` |

---

## ì‹¤ì œ ì‹¤í–‰ ì›Œí¬í”Œë¡œìš°

ì´ ì„¹ì…˜ì€ Main Claudeê°€ ë”°ë¼ì•¼ í•  **êµ¬ì²´ì ì¸ ì‹¤í–‰ ì§€ì¹¨**ì…ë‹ˆë‹¤.

### Step 0: ì‚¬ì „ ì¡°ê±´ í™•ì¸

```bash
# ì„œë²„ ìƒíƒœ í™•ì¸
curl -s http://localhost:7890/health
```

ì„œë²„ê°€ ì‘ë‹µí•˜ì§€ ì•Šìœ¼ë©´:
```
âš ï¸ AFL ì„œë²„ê°€ ì‹¤í–‰ ì¤‘ì´ì§€ ì•ŠìŠµë‹ˆë‹¤.

/afl:setup server ë¥¼ ë¨¼ì € ì‹¤í–‰í•˜ì„¸ìš”.
```

### Step 1: Checkpoint ì •ë³´ ë¡œë“œ

`.afl/sessions/{session-id}/checkpoints/{checkpoint-id}.json` ì—ì„œ checkpoint ì •ë³´ë¥¼ ì½ìŠµë‹ˆë‹¤.

```json
{
  "id": "coupon-service",
  "name": "ì¿ í° ì„œë¹„ìŠ¤ ë¡œì§",
  "description": "ì¿ í° ê²€ì¦ ë° ì ìš© ë¡œì§ êµ¬í˜„",
  "criteria": [
    "CouponService.validate() êµ¬í˜„",
    "CouponService.apply() êµ¬í˜„",
    "ì¤‘ë³µ ì ìš© ë°©ì§€ ë¡œì§"
  ],
  "validation": {
    "command": "pytest tests/test_coupon_service.py",
    "expected": "passed"
  },
  "dependencies": ["coupon-model"]
}
```

### Step 2: Git Worktree ìƒì„±

```bash
# Worktree ë””ë ‰í† ë¦¬ ìƒì„±
mkdir -p .afl/worktrees

# Worktree ìƒì„± (í˜„ì¬ ë¸Œëœì¹˜ ê¸°ë°˜)
git worktree add .afl/worktrees/{checkpoint-id} -b afl/{checkpoint-id}
```

ì‹¤íŒ¨ ì‹œ (ë¸Œëœì¹˜ ì´ë¯¸ ì¡´ì¬):
```bash
git worktree add .afl/worktrees/{checkpoint-id} afl/{checkpoint-id}
```

### Step 3: CLAUDE.md ìƒì„±

Worktree ë£¨íŠ¸ì— Worker Claudeê°€ ì½ì„ ì§€ì‹œì„œë¥¼ ìƒì„±í•©ë‹ˆë‹¤.

```markdown
# Task: {checkpoint-id}

## Objective

{checkpoint.description}

## Success Criteria

ë‹¤ìŒ ê¸°ì¤€ì„ **ëª¨ë‘** ì¶©ì¡±í•´ì•¼ í•©ë‹ˆë‹¤:

{criteriaë¥¼ ì²´í¬ë¦¬ìŠ¤íŠ¸ë¡œ ë³€í™˜}
- [ ] {criteria[0]}
- [ ] {criteria[1]}
- [ ] ...

## Validation

êµ¬í˜„ ì™„ë£Œ í›„ ë‹¤ìŒ ëª…ë ¹ì–´ë¡œ ê²€ì¦í•˜ì„¸ìš”:

```bash
{validation.command}
```

ì˜ˆìƒ ê²°ê³¼: `{validation.expected}`

## Context

### í”„ë¡œì íŠ¸ êµ¬ì¡°
{ê´€ë ¨ íŒŒì¼ êµ¬ì¡° ìš”ì•½}

### ê´€ë ¨ íŒŒì¼
{checkpointì™€ ê´€ë ¨ëœ ì£¼ìš” íŒŒì¼ ëª©ë¡}

### ì°¸ê³  ë¬¸ì„œ
- `.afl/sessions/{session-id}/architecture.md`
- `.afl/sessions/{session-id}/contracts.md`

## Instructions

1. ì´ CLAUDE.md íŒŒì¼ì˜ ì§€ì‹œì‚¬í•­ì„ ë”°ë¥´ì„¸ìš”
2. Success Criteriaì˜ ê° í•­ëª©ì„ ìˆœì„œëŒ€ë¡œ êµ¬í˜„í•˜ì„¸ìš”
3. êµ¬í˜„ í›„ Validation ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•˜ì—¬ í™•ì¸í•˜ì„¸ìš”
4. ëª¨ë“  í…ŒìŠ¤íŠ¸ê°€ í†µê³¼í•˜ë©´ ë³€ê²½ì‚¬í•­ì„ ì»¤ë°‹í•˜ì„¸ìš”

## Constraints

- ìŠ¤í™ì— ëª…ì‹œë˜ì§€ ì•Šì€ ê¸°ëŠ¥ì€ ì¶”ê°€í•˜ì§€ ë§ˆì„¸ìš”
- ê¸°ì¡´ ì½”ë“œ ìŠ¤íƒ€ì¼ì„ ë”°ë¥´ì„¸ìš”
- ê¸°ì¡´ í…ŒìŠ¤íŠ¸ê°€ ê¹¨ì§€ì§€ ì•Šë„ë¡ í•˜ì„¸ìš”
```

Write ë„êµ¬ë¡œ `.afl/worktrees/{checkpoint-id}/CLAUDE.md` ì— ì €ì¥í•©ë‹ˆë‹¤.

### Step 4: ì„œë²„ì— íƒœìŠ¤í¬ ë“±ë¡

```bash
curl -X POST http://localhost:7890/tasks \
  -H "Content-Type: application/json" \
  -d '{
    "checkpoint_id": "{checkpoint-id}",
    "checkpoint_name": "{checkpoint.name}",
    "worktree_path": "{absolute-path-to-worktree}",
    "validation_command": "{validation.command}",
    "max_retries": 3
  }'
```

ì‘ë‹µ:
```json
{ "task_id": "abc123", "status": "queued" }
```

`task_id`ë¥¼ ì €ì¥í•©ë‹ˆë‹¤.

### Step 5: ì§„í–‰ ìƒí™© ëª¨ë‹ˆí„°ë§

íƒœìŠ¤í¬ê°€ ì™„ë£Œë  ë•Œê¹Œì§€ ì£¼ê¸°ì ìœ¼ë¡œ ìƒíƒœë¥¼ í™•ì¸í•©ë‹ˆë‹¤:

```bash
curl -s http://localhost:7890/tasks/{task_id}
```

ìƒíƒœì— ë”°ë¥¸ ì¶œë ¥:

**ì§„í–‰ ì¤‘:**
```
ğŸ”„ coupon-service: 2/3íšŒ ì‹œë„ ì¤‘...
   ë§ˆì§€ë§‰ ì‹¤íŒ¨: "CouponService.validate() í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨"
```

**ì™„ë£Œ:**
```
âœ… coupon-service: ì™„ë£Œ (2íšŒ ì‹œë„)
```

**ì‹¤íŒ¨ (ìµœëŒ€ ì¬ì‹œë„ ì´ˆê³¼):**
```
âŒ coupon-service: ì‹¤íŒ¨ (3/3íšŒ ì‹œë„)
   ì—ìŠ¤ì»¬ë ˆì´ì…˜ í•„ìš”
```

### Step 6: ê²°ê³¼ ì²˜ë¦¬

#### ì„±ê³µ ì‹œ

```bash
# Worktreeì˜ ë³€ê²½ì‚¬í•­ì„ ë©”ì¸ ë¸Œëœì¹˜ë¡œ ë¨¸ì§€
cd .afl/worktrees/{checkpoint-id}
git push origin afl/{checkpoint-id}

# (ì„ íƒ) Worktree ì •ë¦¬
cd ../..
git worktree remove .afl/worktrees/{checkpoint-id}
```

ì‚¬ìš©ìì—ê²Œ ë³´ê³ :
```
âœ… coupon-service êµ¬í˜„ ì™„ë£Œ

  ì‹œë„ íšŸìˆ˜: 2íšŒ
  ë¸Œëœì¹˜: afl/coupon-service

  ë‹¤ìŒ ë‹¨ê³„:
  - /afl:delegate coupon-api (ë‹¤ìŒ checkpoint)
  - git merge afl/coupon-service (ë©”ì¸ì— ë¨¸ì§€)
```

#### ì‹¤íŒ¨ ì‹œ (ì—ìŠ¤ì»¬ë ˆì´ì…˜)

```
âš ï¸ coupon-service ì—ìŠ¤ì»¬ë ˆì´ì…˜

  ì‹œë„ íšŸìˆ˜: 3/3 (ìµœëŒ€ ë„ë‹¬)

  ë°˜ë³µ ì‹¤íŒ¨ ì›ì¸:
  {ì„œë²„ì—ì„œ ë°›ì€ iterations ë¶„ì„}

  ê¶Œì¥ ì¡°ì¹˜:
  1. ì„¤ê³„ ì¬ê²€í† : /afl:architect --resume {session-id}
  2. ìˆ˜ë™ êµ¬í˜„: ì§ì ‘ .afl/worktrees/coupon-service ì—ì„œ ì‘ì—…
  3. Checkpoint ìˆ˜ì •: ê¸°ì¤€ì´ ë„ˆë¬´ ì—„ê²©í•œì§€ í™•ì¸

  ìƒì„¸ ë¡œê·¸: .afl/worktrees/coupon-service/.afl-result/
```

### ì‹¤í–‰ íë¦„ ìš”ì•½

```
/afl:delegate coupon-service
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  1. Git Worktree ìƒì„±                                           â”‚
â”‚                                                                 â”‚
â”‚  git worktree add .afl/worktrees/coupon-service \               â”‚
â”‚    -b afl/coupon-service                                        â”‚
â”‚                                                                 â”‚
â”‚  ê²°ê³¼:                                                          â”‚
â”‚  .afl/worktrees/coupon-service/                                 â”‚
â”‚    â”œâ”€â”€ (í”„ë¡œì íŠ¸ ì „ì²´ ë³µì‚¬)                                     â”‚
â”‚    â”œâ”€â”€ CLAUDE.md  â† Workerì—ê²Œ ì „ë‹¬í•  ì§€ì‹œì„œ                    â”‚
â”‚    â””â”€â”€ .afl-task.json  â† ë©”íƒ€ë°ì´í„°                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  2. CLAUDE.md ìƒì„±                                              â”‚
â”‚                                                                 â”‚
â”‚  # Task: coupon-service                                         â”‚
â”‚                                                                 â”‚
â”‚  ## Objective                                                   â”‚
â”‚  ì¿ í° ì„œë¹„ìŠ¤ ë¡œì§ì„ êµ¬í˜„í•˜ì„¸ìš”.                                 â”‚
â”‚                                                                 â”‚
â”‚  ## Success Criteria                                            â”‚
â”‚  - [ ] CouponService.validate() êµ¬í˜„                            â”‚
â”‚  - [ ] CouponService.apply() êµ¬í˜„                               â”‚
â”‚  - [ ] ì¤‘ë³µ ì ìš© ë°©ì§€ ë¡œì§                                      â”‚
â”‚                                                                 â”‚
â”‚  ## Validation                                                  â”‚
â”‚  pytest tests/test_coupon_service.py                            â”‚
â”‚                                                                 â”‚
â”‚  ## References                                                  â”‚
â”‚  - architecture.md ì°¸ì¡°                                         â”‚
â”‚  - contracts.md ì°¸ì¡°                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  3. ì„œë²„ì— íƒœìŠ¤í¬ ë“±ë¡                                          â”‚
â”‚                                                                 â”‚
â”‚  POST http://localhost:7890/tasks                               â”‚
â”‚  {                                                              â”‚
â”‚    "checkpoint_id": "coupon-service",                           â”‚
â”‚    "checkpoint_name": "ì¿ í° ì„œë¹„ìŠ¤ ë¡œì§",                       â”‚
â”‚    "worktree_path": "/abs/path/.afl/worktrees/coupon-service",  â”‚
â”‚    "validation_command": "pytest tests/test_coupon_service.py", â”‚
â”‚    "max_retries": 3                                             â”‚
â”‚  }                                                              â”‚
â”‚                                                                 â”‚
â”‚  Response: { "task_id": "abc123", "status": "queued" }          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  4. ì„œë²„ê°€ Worker ì‹¤í–‰ (iTerm ìƒˆ íƒ­)                            â”‚
â”‚                                                                 â”‚
â”‚  ì„œë²„ ë‚´ë¶€:                                                     â”‚
â”‚  - osascriptë¡œ iTerm ìƒˆ íƒ­ ì—´ê¸°                                 â”‚
â”‚  - cd /worktree/path                                            â”‚
â”‚  - claude --print "CLAUDE.md ì°¸ì¡°í•˜ì—¬ êµ¬í˜„"                     â”‚
â”‚                                                                 â”‚
â”‚  ì‚¬ìš©ìê°€ iTerm íƒ­ì—ì„œ Worker ì‘ì—… ë‚´ìš© í™•ì¸ ê°€ëŠ¥               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  5. ìë™ í”¼ë“œë°± ë£¨í”„ (ì„œë²„ê°€ ê´€ë¦¬)                              â”‚
â”‚                                                                 â”‚
â”‚  Worker ì™„ë£Œ â†’ Validation ì‹¤í–‰ â†’ ê²°ê³¼ í™•ì¸                      â”‚
â”‚                                                                 â”‚
â”‚  ì‹¤íŒ¨ ì‹œ:                                                       â”‚
â”‚  - CLAUDE.mdì— í”¼ë“œë°± ì¶”ê°€                                      â”‚
â”‚  - Worker ì¬ì‹¤í–‰ (ìµœëŒ€ NíšŒ)                                     â”‚
â”‚                                                                 â”‚
â”‚  ì„±ê³µ ì‹œ:                                                       â”‚
â”‚  - ê²°ê³¼ ì €ì¥                                                    â”‚
â”‚  - Main Claudeì— ì•Œë¦¼                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  6. Main Claudeê°€ ê²°ê³¼ í´ë§                                     â”‚
â”‚                                                                 â”‚
â”‚  GET http://localhost:7890/tasks/abc123                         â”‚
â”‚  {                                                              â”‚
â”‚    "status": "completed",                                       â”‚
â”‚    "final_result": "pass",                                      â”‚
â”‚    "iterations": [...]                                          â”‚
â”‚  }                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Worktree ê´€ë¦¬

```bash
# ìƒì„±ëœ worktree ëª©ë¡
git worktree list

# ì™„ë£Œ í›„ ì •ë¦¬
git worktree remove .afl/worktrees/coupon-service

# ëª¨ë“  AFL worktree ì •ë¦¬
git worktree list | grep ".afl/worktrees" | awk '{print $1}' | xargs -I{} git worktree remove {}
```

### ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§

```bash
# íƒœìŠ¤í¬ ìƒíƒœ ì‹¤ì‹œê°„ ìŠ¤íŠ¸ë¦¬ë°
curl -N http://localhost:7890/tasks/abc123/stream

# ë˜ëŠ” CLIì—ì„œ
watch -n 1 'curl -s http://localhost:7890/tasks/abc123 | jq ".status, .current_iteration"'
```
