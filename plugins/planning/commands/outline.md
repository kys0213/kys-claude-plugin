---
name: outline
description: Claude, Codex, Gemini 3개 LLM으로 동시에 상위 레벨 설계 개요를 작성합니다
argument-hint: "[설계 요청 사항]"
allowed-tools: ["Task", "Glob"]
---

# 상위 레벨 설계 개요 커맨드

Claude, OpenAI Codex, Google Gemini 3개 LLM을 모두 사용하여 상위 레벨 설계 개요를 작성합니다.

기존 plan mode와 달리, 구체적인 코드 수정이 아닌 **아키텍처, 기술 선택, 트레이드오프**를 분석합니다.

## 사용법

```bash
# 기능 설계
/outline "사용자 인증 시스템 구현"
/outline "실시간 알림 기능 추가"

# 기술 선택
/outline "상태 관리 라이브러리 선택"
/outline "DB 마이그레이션 전략"

# 아키텍처 설계
/outline "마이크로서비스로 분리"
/outline "캐싱 레이어 추가"

# 참고 파일 지정
/outline "인증 시스템 설계. 참고: src/auth/**"
```

## 핵심 워크플로우

```
1. 사용자 요청 파싱
2. 참고 파일 경로 수집 (선택)
3. 상위 레벨 설계 프롬프트 구성
4. 3개 Agent에 동일한 프롬프트 병렬 전달
5. 결과 취합 및 통합 요약
```

## 작업 프로세스

### Step 1: 사용자 요청 파싱

사용자 요청에서 추출:
- **설계 주제**: 무엇을 설계할 것인지
- **참고 파일**: "참고:", "기반:", "src/" 등으로 지정된 파일
- **컨텍스트**: 프로젝트 정보, 제약사항 등

### Step 2: 참고 파일 경로 수집 (선택)

참고 파일이 언급되면 Glob으로 경로 수집:

```
Glob: src/auth/**/*.ts
→ ["src/auth/login.ts", "src/auth/session.ts", ...]
```

**CRITICAL**: 파일 내용을 읽지 않습니다! (Agent가 처리)

### Step 3: 상위 레벨 설계 프롬프트 구성

```
설계 요청: [기능/시스템 설명]

컨텍스트:
- 프로젝트: [프로젝트 정보]
- 기존 아키텍처: [있다면]

대상 파일 (참고용):
- path/to/file1.ts
- path/to/file2.ts

사용자 요청:
[원래 사용자 요청]

다음 영역에서 상위 레벨 설계를 제공해주세요:
1. 아키텍처 설계: 주요 컴포넌트, 상호작용, 데이터 흐름
2. 기술 의사결정: 프레임워크/라이브러리/패턴 선택
3. 트레이드오프 분석: 각 접근방식의 장단점

구체적인 코드가 아닌 전략적 수준의 설계를 제공해주세요.
여러 접근방식을 비교하고 각각의 장단점을 명시해주세요.
```

### Step 4: 3개 Agent 병렬 실행

**동일한 프롬프트**를 3개 Agent에 병렬 전달:

```
Task(subagent_type="outline-claude", prompt=PROMPT, run_in_background=true)
Task(subagent_type="outline-codex", prompt=PROMPT, run_in_background=true)
Task(subagent_type="outline-gemini", prompt=PROMPT, run_in_background=true)
```

각 Agent가 처리:
- **Claude**: 프롬프트 파싱 → Read로 파일 읽기 → 직접 설계 분석
- **Codex**: 프롬프트 → 스크립트 (스크립트가 파일 읽기) → Codex CLI
- **Gemini**: 프롬프트 → 스크립트 (스크립트가 파일 읽기) → Gemini CLI

### Step 5: 결과 취합 및 통합 요약

3개 결과를 분석하여 **하나의 통합 요약** 제공:

## 통합 요약 구조

```markdown
# 상위 레벨 설계 종합 분석

## 설계 주제
[사용자가 요청한 설계 주제]

## 핵심 합의사항 (3개 LLM 공통)

### 권장 아키텍처
[3개 LLM이 공통적으로 추천하는 방향]

### 핵심 컴포넌트
1. [컴포넌트 1]: [역할]
2. [컴포넌트 2]: [역할]

## 접근방식 비교

| 접근방식 | Claude | Codex | Gemini | 종합 |
|----------|--------|-------|--------|------|
| A        | 추천   | 추천  | 중립   | 추천 |
| B        | 중립   | 중립  | 추천   | 참고 |

## 트레이드오프 분석

### 접근방식 A
- **장점** (3개 LLM 합의):
  - ...
- **단점** (언급된 우려):
  - ...

### 접근방식 B
- **장점**:
  - ...
- **단점**:
  - ...

## 관점 차이

### Claude만 언급
- [Claude의 독특한 인사이트]

### Codex만 언급
- [Codex의 독특한 인사이트]

### Gemini만 언급
- [Gemini의 독특한 인사이트]

## 최종 권장사항

**추천 접근방식**: [3개 LLM 합의 기반 추천]

**근거**:
1. [합의된 이유 1]
2. [합의된 이유 2]

**다음 단계**:
1. [구체적인 다음 단계]
2. [결정이 필요한 사항]

## 고려사항
- **리스크**: [3개 LLM이 공통적으로 언급한 리스크]
- **의존성**: [필요한 것들]
```

## 주의사항

- **API 필요**: Codex, Gemini CLI 설치 필요
- **상위 레벨만**: 구체적인 코드 수정은 이후 별도 작업
- **다양한 관점**: 3개 LLM의 의견을 통합하되, 차이점도 명시
