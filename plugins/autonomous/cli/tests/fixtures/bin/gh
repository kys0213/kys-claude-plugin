#!/bin/bash
# Fake gh binary for testing
# Behavior controlled by environment variables:
#   GH_MOCK_RESPONSE_FILE - path to JSON file to return for `gh api` calls
#   GH_MOCK_EXIT_CODE     - exit code (default: 0)
#   GH_MOCK_STDERR        - stderr message on failure

exit_code="${GH_MOCK_EXIT_CODE:-0}"

if [ "$1" = "api" ]; then
    if [ -n "$GH_MOCK_RESPONSE_FILE" ]; then
        cat "$GH_MOCK_RESPONSE_FILE"
    else
        echo "[]"
    fi
    exit "$exit_code"
fi

if [ "$1" = "auth" ] && [ "$2" = "token" ]; then
    echo "ghp_fake_token_for_testing"
    exit 0
fi

echo "gh: unknown command '$*'" >&2
exit 1
